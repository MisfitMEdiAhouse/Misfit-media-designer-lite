<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Misfit Media Designer ‚Äî Lite v7.5</title>
  <style>
    :root { --primary:#111111; --accent:#E63946; --font: Inter, Arial, sans-serif; }
    html,body{margin:0;padding:0;background:#f6f6f6;font-family:var(--font)}
    .topbar{display:flex;gap:.5rem;align-items:center;padding:12px 14px;background:#fff;box-shadow:0 2px 10px rgba(0,0,0,.06);position:sticky;top:0;z-index:5}
    .grow{flex:1}
    button,select{font:inherit;padding:6px 10px;border-radius:10px;border:1px solid #ddd;background:#fff}
    .btn{color:#fff;border:none}
    .btn-primary{background:var(--primary)}
    .btn-accent{background:var(--accent)}
    .wrap{padding:16px}
    .board{background:#fff;border-radius:16px;box-shadow:0 10px 24px rgba(0,0,0,.12);overflow:hidden}
    .footer-wm{position:fixed;right:12px;bottom:10px;opacity:.8;user-select:none}
    .hint{font-size:12px;color:#666}
    .home{margin-left:8px}
    .home a{color:#111;text-decoration:none;border:1px solid #ddd;border-radius:10px;padding:6px 10px}
  </style>
</head>
<body>
  <div class="topbar">
    <strong>Misfit Media Designer ‚Äî <span id="mode">Pro Mode</span> (Lite v7.5)</strong>
    <span class="home"><a href="/">‚Üê Home</a></span>
    <span class="grow"></span>
    <label>DPI
      <select id="dpi">
        <option>150</option><option selected>300</option><option>600</option>
      </select>
    </label>
    <button id="btn-svg" class="btn btn-primary">Export SVG</button>
    <button id="btn-png" class="btn btn-primary">Export PNG</button>
    <button id="btn-proof" class="btn btn-accent">Export Proof (PNG)</button>
    <button id="btn-misfit">Enable Misfit Mode</button>
  </div>

  <div class="wrap">
    <div class="hint">18√ó24 in demo artboard ‚Ä¢ Proof adds diagonal ‚ÄúPROOF‚Äù + Misfit watermark (bottom-left)</div>
    <svg id="art" class="board" viewBox="0 0 1800 2400" width="100%" height="auto" xmlns="http://www.w3.org/2000/svg">
      <rect x="0" y="0" width="1800" height="2400" fill="#ffffff"/>
      <text x="80" y="200" font-size="96" font-weight="800" fill="var(--accent)">MISFIT MEDIA</text>
      <text x="80" y="300" font-size="36" font-weight="700" fill="#111">App ‚Ä¢ CRM ‚Ä¢ Design for Brands & Print Shops</text>
      <!-- Demo area -->
      <rect x="80" y="380" width="1640" height="920" rx="24" ry="24" fill="#f1f1f1" stroke="#ddd"/>
      <text x="120" y="520" font-size="54" font-weight="800" fill="#111">Your art goes here</text>
    </svg>
  </div>

  <!-- UI watermark -->
  <div class="footer-wm" title="Powered by Misfit Media">
    <img id="wm-ui" alt="Powered by Misfit Media" height="34"/>
  </div>

<script>
  const svgToURL = (s)=>'data:image/svg+xml;charset=utf-8,'+encodeURIComponent(s);
  const WATERMARK_SVG = `<?xml version="1.0" encoding="UTF-8"?>
  <svg xmlns="http://www.w3.org/2000/svg" width="320" height="80" viewBox="0 0 320 80">
    <g fill="none" stroke="#111" stroke-width="4" stroke-linecap="round" stroke-linejoin="round">
      <path d="M36 10c14 0 26 10 26 26 0 12-7 18-14 22v16h-16v-12h-16v12H64v-16C46 125 30 112 30 86 30 52 56 30 86 30Z" fill="#111"/>
      <circle cx="70" cy="78" r="12" fill="#fff"/><circle cx="102" cy="78" r="12" fill="#fff"/>
      <rect x="74" y="102" width="24" height="8" fill="#fff"/>
      <path d="M126 86 H210" />
      <circle cx="226" cy="86" r="20" fill="#E63946" stroke="#E63946"/>
      <path d="M206 70c12-12 32-16 36 0M206 102c12 12 32 16 36 0" stroke="#E63946"/>
      <path d="M182 86 c16 -28 16 -28 0 0"/>
    </g>
    <g font-family="Inter, Arial, sans-serif" font-weight="800" font-size="22" fill="#111">
      <text x="140" y="36">Powered by</text>
      <text x="140" y="62" fill="#e11">MISFIT MEDIA</text>
    </g>
  </svg>`;

  // Tiny embedded SFX placeholders
  const SFX = {
    riff: "data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABYAaWQAAACcAAAA",
    hiss: "data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABYAaWQAAACcAAAA",
    whoosh: "data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABYAaWQAAACcAAAA"
  };
  const play = k => { try { new Audio(SFX[k]).play(); } catch(e){} };

  // Watermark
  document.getElementById('wm-ui').src = svgToURL(WATERMARK_SVG);

  const art = document.getElementById('art');
  const dpiSel = document.getElementById('dpi');
  const modeEl = document.getElementById('mode');
  const misfitBtn = document.getElementById('btn-misfit');

  let misfitMode = false;

  misfitBtn.onclick = () => {
    misfitMode = !misfitMode;
    modeEl.textContent = misfitMode ? 'PUNK MODE' : 'Pro Mode';
    misfitBtn.textContent = misfitMode ? 'Disable Misfit Mode' : 'Enable Misfit Mode';
    play('riff');
    document.body.style.cursor = misfitMode
      ? `url("data:image/svg+xml,${encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' width='32' height='32'><text y='24' font-size='24'>üíÄ</text></svg>")}") 0 24, auto`
      : 'default';
  };

  art.addEventListener('mousedown', ()=> play('hiss'));

  // Export SVG
  document.getElementById('btn-svg').onclick = ()=>{
    const data = new XMLSerializer().serializeToString(art);
    const a = document.createElement('a');
    a.href = URL.createObjectURL(new Blob([data], {type:'image/svg+xml;charset=utf-8'}));
    a.download = 'misfit-18x24.svg';
    a.click();
  };

  // Export PNG
  document.getElementById('btn-png').onclick = ()=>{
    exportPNG(false);
    play('whoosh');
  };

  // Export Proof PNG
  document.getElementById('btn-proof').onclick = ()=>{
    exportPNG(true);
    play('whoosh');
  };

  function exportPNG(isProof){
    const data = new XMLSerializer().serializeToString(art);
    const img = new Image();
    const url = URL.createObjectURL(new Blob([data], {type:'image/svg+xml;charset=utf-8'}));
    const scale = parseInt(dpiSel.value,10) / 100;
    img.onload = async ()=>{
      const canvas = document.createElement('canvas');
      canvas.width = Math.round(1800*scale);
      canvas.height = Math.round(2400*scale);
      const ctx = canvas.getContext('2d');
      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

      if(isProof){
        ctx.save();
        ctx.translate(canvas.width/2, canvas.height/2);
        ctx.rotate(-Math.atan(canvas.height/canvas.width));
        ctx.globalAlpha = 0.16;
        const fontSize = Math.round(canvas.width*0.14);
        ctx.font = `800 ${fontSize}px Inter, Arial, sans-serif`;
        ctx.textAlign = 'center';
        ctx.lineWidth = Math.max(4, Math.round(fontSize*0.06));
        ctx.strokeStyle = '#FFF';
        ctx.strokeText('PROOF', 0, fontSize/3);
        ctx.fillStyle = '#000';
        ctx.fillText('PROOF', 0, fontSize/3);
        ctx.restore();
        ctx.globalAlpha = 1;

        const wm = new Image();
        wm.onload = ()=>{
          const pad = Math.round(canvas.width*0.02);
          const wmW = Math.round(canvas.width*0.15);
          const ratio = (wm.height||80)/(wm.width||320);
          const wmH = Math.round(wmW*ratio);
          ctx.globalAlpha = 0.95;
          ctx.drawImage(wm, pad, canvas.height - wmH - pad, wmW, wmH);
          finish();
        };
        wm.src = svgToURL(WATERMARK_SVG);
      } else {
        finish();
      }

      function finish(){
        const a = document.createElement('a');
        a.href = canvas.toDataURL('image/png');
        a.download = `${isProof?'proof':'misfit'}-18x24-${dpiSel.value}dpi.png`;
        a.click();
      }
    };
    img.src = url;
  }
</script>
</body>
</html>
